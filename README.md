# 반도체고
## 웨이퍼 품질 비용 정량화 모델을 활용한 구매 가이드라인 수립
> DArt-B 25-2 학술제 SCM 팀

Team Members: 강다훈, 김현수, 박진아, 한혜인, 후영리

---
## 1. 프로젝트 개요
### 배경 (Background)

- 반도체 산업에서의 구매 역할: 구매 직무는 품질(Q), 비용(C), 납기(D)의 균형을 바탕으로 최적 단가를 선정하는 핵심 기능을 담당합니다.

- 품질 리스크의 심각성: 웨이퍼 품질은 수율과 직결되며, 품질 저하 시 불량 증가, 고객 클레임, 라인 정지, 재작업 등 대규모 비용 손실로 이어집니다.

- 현재 산업의 한계:

  - 품질 위험을 정량적인 비용으로 변환하여 구매 단가 결정에 활용할 수 있는 모델이 부재합니다.

  - 단가 협상은 경험·과거 비교 견적에 의존하는 경우가 많아, 숨겨진 품질 비용(Hidden Cost) 이 의사결정에 반영되지 못하는 문제가 존재합니다.

  - 공급사 간 품질 편차가 커지고 있음에도 이를 수치적으로 비교·평가할 기준 부족으로 인해 전략적 구매가 어려운 상황입니다.

### 목표 (Goal)

- 웨이퍼 품질 변동에 따른 기대 비용(Expected Loss)을 계산하는 정량적 모델을 구축합니다.

- 구매자가 품질 위험을 객관적으로 파악하고, 정량적 근거 기반의 최적 단가 전략을 수립할 수 있도록 의사결정 가이드라인(Decision Guideline) 을 제시하는 것을 목표로 합니다.

- 이를 통해 품질·비용·리스크를 균형 있게 반영하는 전략적 구매 체계를 마련하고, 품질 편차로 인한 비용 손실을 사전에 방지하는 구매 의사결정 지원 솔루션을 제공합니다.

---
## 2. 연구 데이터 기반 (Data Basis)

### 데이터 구성 (Dataset Basis)

- 데이터 유형: 실제 웨이퍼 제조 Data는 사용하지 않고, 선행 연구에서 제시된 통계값 및 분포 모델 기반 데이터를 활용하여 모델을 구성하였습니다.

- 참고 문헌 범위: 반도체 수율 모델, 결함 수 분포, 공정 변동성 분석 등 주요 문헌의 정량적 파라미터를 기반으로 구성하였습니다.

모델 입력값 정의 (Model Input Definition)

### 결함 수 모델링(NBD, Negative Binomial Distribution)

- 결함 수는 반도체 제조 연구에서 널리 사용되는 Negative Binomial 분포의 일반적 정의를 따랐습니다.

- 클러스터링 파라미터 α(Alpha) 및 결함 밀도 λ(Lambda)는 Bogdanov 및 관련 수율 모델 연구에서 제시한 산업 평균 범위를 참고하여 설정했습니다.

### 평탄도(TTV, Thickness Total Variation) 파라미터

- TTV의 평균(Mean), 표준편차(σ), 상한 스펙(USL)은 Sharma의 Six Sigma 기반 공정 개선 연구에서 인용하여 사용했습니다.

- 해당 값들은 실제 반도체 공정의 변동성 수준을 반영하도록 조정하였으며, 품질 위험 평가 및 비용 계산 모델의 입력값으로 활용되었습니다.

---
## 3. 핵심 분석 구조 및 방법론 (Core Modeling & Methodology)

단순 통계가 아닌, 확률 기반 수율 모델링, 품질비용 정량화, 민감도 분석을 통해 웨이퍼 품질 변화가 단가에 미치는 구조적 영향을 체계적으로 분석했습니다.

### ① 결함 수 기반 수율 모델링 (Defect-Based Yield Modeling)

- 접근법: 반도체 웨이퍼는 미세 결함(Defects)이 수율을 좌우하므로, 결함 수(Defect Count)를 확률 변수로 보고 수율을 계산했습니다.

- Methodology:

  - 결함 수는 산업계에서 널리 사용되는 Negative Binomial Distribution (NBD) 로 모델링했습니다.

  - 결함 밀도 λ(Lambda) 와 클러스터링 지수 α(Alpha) 를 기반으로 불량 기준 K 이상일 확률 P(D ≥ K) 를 산출했습니다.

  - λ는 공정 평균 결함 수준을 나타내는 1차 핵심 변수, α는 결함의 공간적 군집 정도를 나타내는 보조 변수로 설정했습니다.

  - 두 파라미터의 조합을 통해 웨이퍼 단위 불량률을 정량화했습니다.
 
### ② 평탄도 기반 불량 확률 모델링 (TTV-Based Failure Probability)

- 접근법: 두께 평탄도(TTV)는 공정 정밀도의 핵심 품질 특성으로, 목표 스펙을 벗어나면 치명적 결함으로 이어집니다.

- Methodology:

  - TTV는 평균(μ)과 표준편차(σ)를 갖는 정규분포(Normal Distribution) 로 가정하여 모델링했습니다.

  - 스펙 한계(USL)를 기반으로 P(TTV > USL) 불량 확률을 계산했습니다.

  - μ는 평탄도의 전반적 수준을, σ는 변동성을 나타내며 μ·σ 조합이 악화될수록 비용이 기하급수적으로 증가하는 구조를 확인했습니다.
 
### ③ 결함수 + 평탄도 통합 불량률 (Combined Failure Mechanism)

- 접근법: 결함 수와 TTV 불량 메커니즘은 서로 독립적으로 발생한다고 가정했습니다.

- Methodology:

  - 두 불량 확률을 독립 결합하여 최종 웨이퍼 불량률을 계산했습니다.

  - AQL 샘플링 검사 구조와 장비 측정 오차를 반영해 로트(Lot) 통과 확률을 산출했습니다.

  - 이후 불량 출하·재작업·폐기·검사비용·기회비용을 포함해 기대 품질비용(E[Cost]) 을 정의했습니다.
 
### ④ 민감도 분석 (Sensitivity Analysis of Quality Parameters)

- 접근법: λ·α·μ·σ 네 가지 핵심 품질 파라미터의 변화가 비용과 단가에 미치는 영향을 정량적으로 해석했습니다.

- Methodology:

  - 결함 수 모델(λ·α):

    - λ가 비용을 결정하는 1차 지배 변수로 나타나, λ가 기준값을 넘으면 비용 절벽(Cost Cliff) 이 형성됨을 확인했습니다.

    - α는 λ가 낮거나 중간일 때만 비용 감소 효과가 두드러지는 완충 변수로 작용했습니다.

  - 평탄도 모델(μ·σ):

    - μ는 전체 품질 수준을, σ는 비용 폭증을 유발하는 촉매 역할을 수행했습니다.

    - μ·σ가 동시에 악화될 경우 비용이 기하급수적으로 상승해 공정 관리 포인트의 중요성을 보여줍니다.
   
  ### ⑤ 단가 조정 가이드라인 (Price Adjustment Guideline)

- 접근법: 품질 변화가 단가에 어떻게 반영되어야 하는지, 공급사 협상력까지 고려한 현실적 단가 조정 체계를 설계했습니다.

- Methodology:

  - 품질비용 기반 단가 인상/감액 구조를 정의하여

    - 품질 개선 → 단가 인상 근거

    - 품질 악화 → 단가 감액 근거로 연결되는 방향성을 제시했습니다.

  - 웨이퍼 시장의 공급자 우위 구조를 고려하여 100% 반영이 어려운 ΔPrice%에 대해 공급사 Tier별 탄력계수 k 를 차등 적용했습니다.

    - Tier1: k = 0.3 (안정성·파트너십 중심)

    - Tier3: k = 0.7 (품질 개선 유도 중심)
   
---
## 4. LLM 기반 단가 계산기 (LLM-Driven Price Calculator)

<img width="500" height="300" alt="image" src="https://github.com/user-attachments/assets/0891f583-1a68-4765-ab08-1c7e53228ea2" />
<img width="400" height="300" alt="image" src="https://github.com/user-attachments/assets/f5d436a4-3629-4fc2-b3a8-1f56e0843aa8" />

본 연구에서는 품질–단가 모델을 실제 의사결정에 활용 가능한 형태로 구현하기 위해

LLM 기반 단가 계산기(Price Calculator) 를 개발하였습니다.

- 기존 엑셀 기반 계산 방식은 변수 변경, 시나리오 비교, 다차원 파라미터 분석에 한계가 있었습니다.

- 본 시스템은 자연어로 λ(결함 밀도) · α(클러스터링 지수) · μ(평탄도 평균) · σ(평탄도 표준편차) 를 입력하면 즉시 불량률, 기대 품질비용, 단가 변동률(ΔPrice%) 을 자동 산출합니다.

또한 계산기는 4D Price Sensitivity Surface 와 연동되어 있어

결함(λ·α)과 평탄도(μ·σ)의 조합이 단가에 미치는 영향을 시각적으로 한눈에 비교할 수 있습니다.

이 기능을 활용하면 협상 과정에서 공급사에게:

- “어떤 품질 개선이 실제로 얼마만큼의 단가 변화로 이어지는지”

- “품질 개선 시 구매사–공급사 모두에게 발생하는 금전적 효과가 무엇인지”

를 정량적 근거로 제시할 수 있어 협상의 투명성과 속도를 크게 향상시킵니다.

결과적으로 LLM 단가 계산기는

단순 계산을 넘어 품질 기반 단가 협상의 실시간 의사결정 엔진으로 활용될 수 있으며,

품질 개선–단가 조정의 인과 관계를 명확히 보여주는 전략적 구매 지원 도구로 기능합니다.

---
## 5. 데이터 활용 및 연구 확장 가능성 (Future Directions)

### ① 실제 제조 데이터 기반의 모델 고도화 (Real Manufacturing Data Integration)

현재 모델은 문헌 기반 파라미터와 이론적 분포를 활용해 구성되었으나,

향후 공정별 실측 TTV 로그, 결함 맵(wafer map), 로트 이력(lot history) 데이터를 연동할 경우
λ·α·μ·σ 추정 정확도가 크게 향상됩니다.

또한 장비 특성(inspection sensitivity), 공정 단계별 리스크, 로트 간 변동성을 반영하면
품질비용 예측력이 산업 수준으로 고도화될 수 있습니다.

### ② 공간적 결함 패턴 분석 확대 (Spatial Yield Modeling Expansion)

기존의 결함 수 기반 모델을 넘어, wafer map 기반의 공간적 패턴 분석을 접목할 수 있습니다.

- CNN 기반 결함 패턴 분류

- 스팟·링·스크래치 등 클러스터 탐지

- 공간 상관 모델(CAR, GMRF 등)을 통한 패턴 위험도 추정

이를 통해 결함 위치와 패턴의 위험도를 단가 반영에 포함할 수 있으며,

공급사 간 품질 수준을 더 명확히 구분하고

고위험 패턴에 대한 페널티 정책까지 설계 가능해집니다.

### ③ 품질–단가 시뮬레이션 플랫폼 확장 (Simulation Platform Evolution)

현재 LLM 단가 계산기는 λ·α·μ·σ 입력값을 기반으로 단가 변동률을 산출하는 구조입니다.

향후에는 다음과 같은 의사결정 플랫폼 형태로 확장될 수 있습니다:

- 자동 시나리오 생성

- 4D Sensitivity Surface 자동 생성

- 공급사별 품질–단가 Dashboard

- 자동 보고서 생성, 협상 자료 요약

이를 통해 구매자는 여러 조건을 즉시 비교하며
실시간 품질 기반 의사결정을 수행할 수 있게 됩니다.

### ④ 공급사 관리 및 협상 전략 모델링 (Supplier Strategy Modeling)

Tier별 협상 탄력 계수 k를 고도화하여,

공급사 품질 개선 속도, 과거 클레임 이력, 기술적 한계 등을

정량·정성 scoring 방식으로 반영할 수 있습니다.

이를 통해 실제 협상에서는:

- 객관적 품질 기반 단가 정책 적용

- 공급사별 맞춤 협상 전략 설계

- 장기적 파트너십 관리 체계 구축

이 가능해집니다.

### ⑤ 산업 적용 확장성 (Scalability Across Semiconductor Processes)

본 연구에서 제시한

“품질 리스크 → 비용 → 단가 반영” 프레임워크는

웨이퍼 제조뿐 아니라 다음과 같은 공정에도 동일하게 적용할 수 있습니다:

- CMP (스크래치, 두께 variation)

- Lithography (overlay error, LER)

- Etch (critical dimension variation)

이를 통해 반도체 제조 전반에서

품질 기반 비용 최적화·전략적 구매 체계를 확장할 수 있으며,

기업 전체 품질 전략에 직접 기여할 수 있습니다.

---
## 6. Tech Stack

- Language: Python 3.x
- Data Analysis: NumPy, Pandas, SciPy (stats, special)
- Visualization: Matplotlib, Seaborn, mpl_toolkits.mplot3d
- Interactive Tools: ipywidgets (interact)
- File Handling: google.colab.files
- Application & Deployment: Streamlit, OpenAI API, OS
- Environment: Jupyter Notebook / Google Colab
